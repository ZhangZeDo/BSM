(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2d221dc9"],{cbc7:function(e,t,r){"use strict";r.r(t);var a=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",[e._m(0),r("el-card",{staticStyle:{margin:"20px 100px"}},[r("div",{staticStyle:{height:"30px"},attrs:{slot:"header"},slot:"header"},[r("div",{staticStyle:{float:"left","margin-right":"10px"}},[r("label",{},[e._v("任务名称:")])]),r("div",{staticStyle:{float:"left","margin-right":"10px"}},[r("el-input",{attrs:{size:"small",placeholder:"搜索任务名称",clearable:""},on:{change:function(t){return e.queryData()}},model:{value:e.queryForm.searchInput,callback:function(t){e.$set(e.queryForm,"searchInput",t)},expression:"queryForm.searchInput"}},[r("i",{staticClass:"el-input__icon el-icon-search",attrs:{slot:"prefix"},slot:"prefix"})])],1),r("div",{staticStyle:{float:"right","margin-right":"10px"}},[r("el-button",{staticClass:"el-icon-refresh",attrs:{size:"small"},on:{click:function(t){return e.queryData()}}}),r("el-button",{attrs:{type:"primary",size:"small"},on:{click:e.showJobDialog}},[e._v("新增")])],1)]),r("div",[r("el-table",{staticStyle:{width:"100%"},attrs:{data:e.jobList,stripe:""}},[r("el-table-column",{staticStyle:{width:"10%"},attrs:{align:"center",prop:"jobName",label:"任务名称"}}),r("el-table-column",{staticStyle:{width:"10%"},attrs:{align:"center",prop:"cronExpression",label:"时间表达式"}}),r("el-table-column",{staticStyle:{width:"5%"},attrs:{align:"center",label:"状态"},scopedSlots:e._u([{key:"default",fn:function(t){return[0==t.row.status?r("el-button",{attrs:{size:"mini",type:"success"},on:{click:function(r){return e.updateJobStatus(t.row)}}},[e._v("启用 ")]):e._e(),1==t.row.status?r("el-button",{attrs:{size:"mini",type:"danger"},on:{click:function(r){return e.updateJobStatus(t.row)}}},[e._v("禁用 ")]):e._e()]}}])}),r("el-table-column",{staticStyle:{width:"10%"},attrs:{align:"center",prop:"methodName",label:"方法名称"}}),r("el-table-column",{staticStyle:{width:"10%"},attrs:{align:"center",prop:"beanClazz",label:"beanId"}}),r("el-table-column",{staticStyle:{width:"5%"},attrs:{align:"center",prop:"params",label:"参数"},scopedSlots:e._u([{key:"default",fn:function(t){return[r("el-popover",{attrs:{placement:"bottom",width:"800",trigger:"click"}},[r("div",[e._v(" "+e._s(t.row.params)+" ")]),r("el-button",{attrs:{slot:"reference",type:"text"},slot:"reference"},[e._v(e._s(e.shortCut(t.row.params,10)))])],1)]}}])}),r("el-table-column",{staticStyle:{width:"40%"},attrs:{align:"center",label:"操作"},scopedSlots:e._u([{key:"default",fn:function(t){return[r("el-button",{attrs:{type:"primary",size:"mini"},on:{click:function(r){return e.showEditJobDialog(t.row)}}},[e._v("编辑")]),r("el-button",{attrs:{type:"primary",size:"mini"},on:{click:function(r){return e.runJob(t.row)}}},[e._v("立即执行")])]}}])})],1)],1),r("div",{staticStyle:{"padding-top":"20px"}},[r("div",{staticClass:"block"},[r("el-pagination",{attrs:{"current-page":e.queryForm.page,"page-size":e.queryForm.pageSize,"page-sizes":[5,10,15,20],layout:"total,sizes, prev ,pager, next, jumper",total:e.total},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}})],1)]),r("el-dialog",{attrs:{title:"新建定时任务",visible:e.createJobDialog,width:"50%",center:""},on:{"update:visible":function(t){e.createJobDialog=t}}},[r("el-form",{ref:"ruleForm",staticClass:"demo-ruleForm",attrs:{model:e.ruleForm,rules:e.rules,"label-width":"100px"}},[r("el-form-item",{attrs:{label:"任务名称",prop:"jobName"}},[r("el-input",{attrs:{placeholder:"请输入任务名称"},model:{value:e.ruleForm.jobName,callback:function(t){e.$set(e.ruleForm,"jobName",t)},expression:"ruleForm.jobName"}})],1),r("el-form-item",{attrs:{label:"任务组",prop:"jobGroup"}},[r("el-input",{attrs:{placeholder:"请输入任务组"},model:{value:e.ruleForm.jobGroup,callback:function(t){e.$set(e.ruleForm,"jobGroup",t)},expression:"ruleForm.jobGroup"}})],1),r("el-form-item",{attrs:{label:"时间表达式",prop:"cronExpression"}},[r("el-input",{attrs:{placeholder:"请输入时间表达式"},model:{value:e.ruleForm.cronExpression,callback:function(t){e.$set(e.ruleForm,"cronExpression",t)},expression:"ruleForm.cronExpression"}})],1),r("el-form-item",{attrs:{label:"方法名称",prop:"methodName"}},[r("el-input",{attrs:{placeholder:"请输入方法名称"},model:{value:e.ruleForm.methodName,callback:function(t){e.$set(e.ruleForm,"methodName",t)},expression:"ruleForm.methodName"}})],1),r("el-form-item",{attrs:{label:"beanId",prop:"beanId"}},[r("el-input",{attrs:{placeholder:"请输入beanId"},model:{value:e.ruleForm.beanClazz,callback:function(t){e.$set(e.ruleForm,"beanClazz",t)},expression:"ruleForm.beanClazz"}})],1),r("el-form-item",{attrs:{label:"参数",prop:"params"}},[r("el-input",{attrs:{type:"textarea",rows:6,placeholder:"请输入参数，以json格式"},model:{value:e.ruleForm.params,callback:function(t){e.$set(e.ruleForm,"params",t)},expression:"ruleForm.params"}})],1),r("el-form-item",{attrs:{label:"备注",prop:"remark"}},[r("el-input",{attrs:{type:"textarea",rows:4,placeholder:"请输入备注"},model:{value:e.ruleForm.remark,callback:function(t){e.$set(e.ruleForm,"remark",t)},expression:"ruleForm.remark"}})],1)],1),r("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[r("el-button",{on:{click:function(t){e.createJobDialog=!1}}},[e._v("取 消")]),r("el-button",{attrs:{type:"primary"},on:{click:e.submitCreateForm}},[e._v("确 定")])],1)],1),r("el-dialog",{attrs:{title:"编辑定时任务",visible:e.editJobDialog,width:"50%",center:""},on:{"update:visible":function(t){e.editJobDialog=t}}},[r("el-form",{ref:"ruleForm",staticClass:"demo-ruleForm",attrs:{model:e.editForm,rules:e.rules,"label-width":"100px"}},[r("el-form-item",{attrs:{label:"任务名称",prop:"jobName"}},[r("el-input",{attrs:{placeholder:"请输入任务名称"},model:{value:e.editForm.jobName,callback:function(t){e.$set(e.editForm,"jobName",t)},expression:"editForm.jobName"}})],1),r("el-form-item",{attrs:{label:"任务组",prop:"jobGroup"}},[r("el-input",{attrs:{placeholder:"请输入任务组"},model:{value:e.editForm.jobGroup,callback:function(t){e.$set(e.editForm,"jobGroup",t)},expression:"editForm.jobGroup"}})],1),r("el-form-item",{attrs:{label:"时间表达式",prop:"cronExpression"}},[r("el-input",{attrs:{placeholder:"请输入时间表达式"},model:{value:e.editForm.cronExpression,callback:function(t){e.$set(e.editForm,"cronExpression",t)},expression:"editForm.cronExpression"}})],1),r("el-form-item",{attrs:{label:"方法名称",prop:"methodName"}},[r("el-input",{attrs:{placeholder:"请输入方法名称"},model:{value:e.editForm.methodName,callback:function(t){e.$set(e.editForm,"methodName",t)},expression:"editForm.methodName"}})],1),r("el-form-item",{attrs:{label:"beanId",prop:"beanId"}},[r("el-input",{attrs:{placeholder:"请输入beanId"},model:{value:e.editForm.beanClazz,callback:function(t){e.$set(e.editForm,"beanClazz",t)},expression:"editForm.beanClazz"}})],1),r("el-form-item",{attrs:{label:"参数",prop:"params"}},[r("el-input",{attrs:{type:"textarea",rows:6,placeholder:"请输入参数，以json格式"},model:{value:e.editForm.params,callback:function(t){e.$set(e.editForm,"params",t)},expression:"editForm.params"}})],1),r("el-form-item",{attrs:{label:"备注",prop:"remark"}},[r("el-input",{attrs:{type:"textarea",rows:4,placeholder:"请输入备注"},model:{value:e.editForm.remark,callback:function(t){e.$set(e.editForm,"remark",t)},expression:"editForm.remark"}})],1)],1),r("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[r("el-button",{on:{click:function(t){e.editJobDialog=!1}}},[e._v("取 消")]),r("el-button",{attrs:{type:"primary"},on:{click:e.submitEditForm}},[e._v("确 定")])],1)],1)],1)],1)},o=[function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"card-header",staticStyle:{"margin-top":"20px","margin-left":"100px"}},[r("h3",[e._v("任务列表")])])}],l={name:"timingTask",data:function(){return{createJobDialog:!1,editJobDialog:!1,queryForm:{page:1,pageSize:5,searchInput:""},total:0,jobList:[],ruleForm:{id:"",jobName:"",jobGroup:"",cronExpression:"",methodName:"",beanClazz:"",params:"",remark:""},editForm:{id:"",jobName:"",jobGroup:"",cronExpression:"",methodName:"",beanClazz:"",params:"",remark:""},rules:{jobName:[{required:!0,message:"请输入任务名称",trigger:"blur"},{min:3,max:20,message:"长度在 3 到 20 个字符",trigger:"blur"}],jobGroup:[{required:!0,message:"请输入任务组",trigger:"blur"},{min:3,max:20,message:"长度在 3 到 20 个字符",trigger:"blur"}],cronExpression:[{required:!0,message:"请输入时间表达式",trigger:"blur"},{min:3,max:20,message:"长度在 3 到 20 个字符",trigger:"blur"}],methodName:[{required:!0,message:"请输入方法名称",trigger:"blur"},{min:3,max:20,message:"长度在 3 到 20 个字符",trigger:"blur"}],beanClazz:[{required:!0,message:"请输入beanId",trigger:"blur"},{min:3,max:100,message:"长度在 3 到 100 个字符",trigger:"blur"}]}}},created:function(){this.queryData()},methods:{queryData:function(){var e=this;this.$axios.post("/job/queryJobList",{page:this.queryForm.page,pageSize:this.queryForm.pageSize,searchInput:this.queryForm.searchInput}).then((function(t){200==t.code&&(e.jobList=t.data.items,e.total=t.data.total)}))},updateJobStatus:function(e){var t=this;this.$axios.post("/job/updateJobStatus",{id:e.id,status:e.status}).then((function(e){200==e.code&&t.$message.success("操作成功"),t.queryData()}))},shortCut:function(e,t){return e&&e.length>t?e.substring(0,t)+"...":e},showJobDialog:function(){this.createJobDialog=!0},submitCreateForm:function(){var e=this;this.$axios.post("/job/addJob",{jobName:this.ruleForm.jobName,jobGroup:this.ruleForm.jobGroup,cronExpression:this.ruleForm.cronExpression,methodName:this.ruleForm.methodName,beanClazz:this.ruleForm.beanClazz,params:this.ruleForm.params,remark:this.ruleForm.remark}).then((function(t){200==t.code&&(e.$message.success("添加成功"),e.queryData(),e.createJobDialog=!1),e.queryData()}))},showEditJobDialog:function(e){this.editForm=e,this.editJobDialog=!0},submitEditForm:function(){var e=this;this.$axios.post("/job/editJob",{id:this.editForm.id,jobName:this.editForm.jobName,jobGroup:this.editForm.jobGroup,status:this.editForm.status,cronExpression:this.editForm.cronExpression,methodName:this.editForm.methodName,beanClazz:this.editForm.beanClazz,params:this.editForm.params,remark:this.editForm.remark}).then((function(t){200==t.code&&(e.$message.success("编辑成功"),e.queryData(),e.editJobDialog=!1),e.queryData()}))},handleSizeChange:function(e){this.queryForm.pageSize=e,this.queryData()},handleCurrentChange:function(e){this.queryForm.page=e,this.queryData()},runJob:function(e){var t=this;this.$axios.post("/job/runJob",{jobName:e.jobName,jobGroup:e.jobGroup}).then((function(e){200==e.code&&t.$message.success("操作成功，后台正在执行")}))}}},i=l,s=r("2877"),n=Object(s["a"])(i,a,o,!1,null,"70de3d7a",null);t["default"]=n.exports}}]);
//# sourceMappingURL=chunk-2d221dc9.882437b3.js.map