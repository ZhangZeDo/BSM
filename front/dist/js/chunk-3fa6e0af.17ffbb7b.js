(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-3fa6e0af"],{2950:function(e,t,a){"use strict";var i=a("4ef5"),r=a.n(i);r.a},"4ef5":function(e,t,a){},"6fe5":function(e,t,a){"use strict";a.r(t);var i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[e._m(0),a("el-card",{staticStyle:{margin:"20px 100px"}},[a("div",{staticStyle:{height:"30px"},attrs:{slot:"header"},slot:"header"},[a("el-button",{staticStyle:{float:"left"},attrs:{type:"primary"},on:{click:function(t){e.centerDialogVisible=!0}}},[e._v("新建上传")]),a("div",{staticStyle:{float:"right"}},[a("el-button",{attrs:{size:"small"},on:{click:e.queryData}},[e._v("搜索")])],1),a("div",{staticStyle:{float:"right","margin-right":"10px"}},[a("el-input",{attrs:{size:"small",placeholder:"搜索标题/描述",clearable:""},model:{value:e.queryForm.searchInput,callback:function(t){e.$set(e.queryForm,"searchInput",t)},expression:"queryForm.searchInput"}},[a("i",{staticClass:"el-input__icon el-icon-search",attrs:{slot:"prefix"},slot:"prefix"})])],1),a("div",{staticStyle:{float:"right","margin-right":"10px"}},[a("el-select",{attrs:{size:"small",clearable:"",placeholder:"请选择作品类型"},model:{value:e.queryForm.mediaType,callback:function(t){e.$set(e.queryForm,"mediaType",t)},expression:"queryForm.mediaType"}},e._l(e.mediaTypeList,(function(e){return a("el-option",{key:e.id,attrs:{label:e.typeName,value:e.id}})})),1)],1)],1),a("div",[a("el-row",{staticStyle:{padding:"0 20px"}},[a("el-row",e._l(e.mediaWorks,(function(t){return a("el-col",{key:t.id,attrs:{span:8}},[a("el-card",{staticStyle:{margin:"10px 20px",width:"500px",height:"150px",float:"left"}},[a("div",{staticStyle:{float:"left"}},[a("img",{staticClass:"image",staticStyle:{width:"150px",height:"110px"},attrs:{src:t.mediaCover},on:{click:function(a){return e.showDetail(t.id)}}})]),a("div",{staticStyle:{float:"left",width:"250px","padding-left":"5px"}},[a("span",[e._v(e._s(t.mediaName))]),a("br"),a("br"),a("span",[e._v("评分:"+e._s(t.mediaGrade))]),a("br"),a("br"),t.mediaRemark.length<35?a("span",{staticStyle:{"font-size":"x-small"}},[e._v(e._s(t.mediaRemark))]):a("span",{staticStyle:{"font-size":"x-small"}},[e._v(e._s(t.mediaRemark.substring(0,35))+"...")])]),a("div",{staticStyle:{float:"right","padding-top":"90px"}},[a("el-button",{attrs:{type:"text"},on:{click:function(a){return e.open(t.id)}}},[e._v("移除")])],1)])],1)})),1)],1)],1),a("div",{staticStyle:{"margin-bottom":"10px"},attrs:{align:"center"}},[a("div",{staticClass:"block",staticStyle:{padding:"0 32px"}},[a("el-pagination",{attrs:{"current-page":e.queryForm.page,"page-size":e.queryForm.pageSize,"page-sizes":[6,9,12,15],layout:"total,sizes , prev, pager, next, jumper",total:e.total},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}})],1)])]),a("el-dialog",{attrs:{title:"新建上传",visible:e.centerDialogVisible,width:"40%",center:""},on:{"update:visible":function(t){e.centerDialogVisible=t}}},[a("el-form",{ref:"ruleForm",staticClass:"demo-ruleForm",attrs:{model:e.ruleForm,rules:e.rules,"label-width":"100px"}},[a("el-form-item",{attrs:{label:"作品名称",prop:"mediaName"}},[a("el-input",{attrs:{placeholder:"请输入作品名称"},model:{value:e.ruleForm.mediaName,callback:function(t){e.$set(e.ruleForm,"mediaName",t)},expression:"ruleForm.mediaName"}})],1),a("el-form-item",{attrs:{label:"作品类型",prop:"mediaType"}},[a("el-select",{attrs:{size:"small",placeholder:"请选择作品类型"},model:{value:e.ruleForm.mediaType,callback:function(t){e.$set(e.ruleForm,"mediaType",t)},expression:"ruleForm.mediaType"}},e._l(e.mediaTypeList,(function(e){return a("el-option",{key:e.id,attrs:{label:e.typeName,value:e.id}})})),1)],1),a("el-form-item",{attrs:{label:"作品描述",prop:"mediaRemark"}},[a("el-input",{attrs:{type:"textarea"},model:{value:e.ruleForm.mediaRemark,callback:function(t){e.$set(e.ruleForm,"mediaRemark",t)},expression:"ruleForm.mediaRemark"}})],1),a("el-form-item",[a("div",{staticStyle:{float:"left","padding-left":"100px"}},[a("el-upload",{ref:"upload",staticClass:"upload-demo",attrs:{action:"","on-preview":e.handlePreview,"on-remove":e.handleRemove,"before-remove":e.beforeRemove,multiple:"",limit:1,accept:"image/jpeg,image/gif,image/png,image/bmp","on-exceed":e.handleExceed,"auto-upload":!1,"on-change":e.onChangeCover,"file-list":e.coverFileList}},[a("el-button",{attrs:{size:"small",type:"primary"}},[e._v("点击上传封面")]),a("div",{staticClass:"el-upload__tip",attrs:{slot:"tip"},slot:"tip"},[e._v("只能上传png/gif/png/bmp文件")])],1)],1),a("div",{staticStyle:{float:"left","padding-left":"100px"}},[a("el-upload",{ref:"upload",staticClass:"upload-demo",attrs:{action:"","on-preview":e.handlePreview,"on-remove":e.handleRemove,"before-remove":e.beforeRemove,multiple:"",limit:1,accept:"audio/mpeg,video/mp4","on-exceed":e.handleExceed,"auto-upload":!1,"on-change":e.onChangeMedia,"file-list":e.mediaFileList}},[a("el-button",{attrs:{size:"small",type:"primary"}},[e._v("点击上传视频")]),a("div",{staticClass:"el-upload__tip",attrs:{slot:"tip"},slot:"tip"},[e._v("只能上传mp3/mp4文件")])],1)],1)])],1),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.centerDialogVisible=!1}}},[e._v("取 消")]),a("el-button",{attrs:{type:"primary"},on:{click:e.submitForm}},[e._v("确 定")])],1)],1)],1)},r=[function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"card-header",staticStyle:{"margin-top":"20px","margin-left":"100px"}},[a("h3",[e._v("我的上传")])])}],l=(a("b0c0"),a("bc3a")),o=a.n(l),s={name:"fileUpload",data:function(){return{centerDialogVisible:!1,ruleForm:{mediaName:"",mediaRemark:"",mediaType:""},mediaTypeList:[],coverFileList:[],mediaFileList:[],mediaWorks:[],queryForm:{status:1,mediaType:"",searchInput:"",pageSize:6,page:1,belongTo:!0},total:0,rules:{mediaName:[{required:!0,message:"请输入作品名称",trigger:"blur"},{min:1,max:20,message:"长度在 1 到 20个字符",trigger:"blur"}],mediaType:[{required:!0,message:"请选择作品类型",trigger:"change"}],mediaRemark:[{required:!0,message:"请填写作品描述",trigger:"blur"}]}}},created:function(){this.getAllMediaType(),this.queryData()},methods:{open:function(e){var t=this;this.$confirm("此操作将永久删除该作品, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){t.$axios.post("/mediaWork/changeMediaWorkStatus",{id:e,status:0}).then((function(e){200==e.code&&(t.$message.success("操作成功"),t.queryData())}))}))},handleSizeChange:function(e){this.queryForm.pageSize=e,this.queryData()},handleCurrentChange:function(e){this.queryForm.page=e,this.queryData()},onChangeCover:function(e,t){this.coverFileList=t},onChangeMedia:function(e,t){this.mediaFileList=t},getAllMediaType:function(){var e=this;this.$axios.post("/mediaType/getAllMediaType",{status:"1"}).then((function(t){200==t.code&&(e.mediaTypeList=t.data)}))},submitForm:function(){var e=this,t=new FormData;t.append("coverFile",this.coverFileList[0].raw),t.append("mediaFile",this.mediaFileList[0].raw),t.append("mediaName",this.ruleForm.mediaName),t.append("mediaRemark",this.ruleForm.mediaRemark),t.append("mediaType",this.ruleForm.mediaType),o()({method:"POST",url:"http://129.204.251.179:8083/mediaWork/uploadMediaWork",data:t,headers:{"Content-Type":"multipart/form-data"},timeout:18e4}).then((function(t){200==t.data.code?(e.$message.success("上传成功"),e.centerDialogVisible=!1):e.$message.error(t.data.message)}))},queryData:function(){var e=this;this.$axios.post("/mediaWork/mediaWorkList",{status:this.queryForm.status,mediaType:this.queryForm.mediaType,searchInput:this.queryForm.searchInput,pageSize:this.queryForm.pageSize,page:this.queryForm.page,belongTo:this.queryForm.belongTo}).then((function(t){200==t.code&&(e.mediaWorks=t.data.items,e.total=t.data.total)}))},handleRemove:function(e){window.console.log(e)},handlePreview:function(e){window.console.log(e)},handleExceed:function(){this.$message.warning("只能选择一个文件")},beforeRemove:function(e){return window.console.log(e),this.$confirm("确定移除 ".concat(e.name,"？"))},showDetail:function(e){this.$router.push({path:"/mediaDetail",query:{mediaId:e}})}}},n=s,m=(a("2950"),a("2877")),d=Object(m["a"])(n,i,r,!1,null,"20a6e3ab",null);t["default"]=d.exports},b0c0:function(e,t,a){var i=a("83ab"),r=a("9bf2").f,l=Function.prototype,o=l.toString,s=/^\s*function ([^ (]*)/,n="name";!i||n in l||r(l,n,{configurable:!0,get:function(){try{return o.call(this).match(s)[1]}catch(e){return""}}})}}]);
//# sourceMappingURL=chunk-3fa6e0af.17ffbb7b.js.map